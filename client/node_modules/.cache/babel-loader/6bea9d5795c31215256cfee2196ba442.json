{"ast":null,"code":"const fetch = require('npm-registry-fetch');\n\nconst npa = require('npm-package-arg');\n\nconst log = require('../utils/log-shim');\n\nconst getIdentity = require('../utils/get-identity');\n\nconst BaseCommand = require('../base-command.js');\n\nclass Star extends BaseCommand {\n  static description = 'Mark your favorite packages';\n  static name = 'star';\n  static usage = ['[<package-spec>...]'];\n  static params = ['registry', 'unicode', 'otp'];\n  static ignoreImplicitWorkspace = false;\n\n  async exec(args) {\n    if (!args.length) {\n      throw this.usageError();\n    } // if we're unstarring, then show an empty star image\n    // otherwise, show the full star image\n\n\n    const unicode = this.npm.config.get('unicode');\n    const full = unicode ? '\\u2605 ' : '(*)';\n    const empty = unicode ? '\\u2606 ' : '( )';\n    const show = this.name === 'star' ? full : empty;\n    const pkgs = args.map(npa);\n    const username = await getIdentity(this.npm, this.npm.flatOptions);\n\n    for (const pkg of pkgs) {\n      const fullData = await fetch.json(pkg.escapedName, { ...this.npm.flatOptions,\n        spec: pkg,\n        query: {\n          write: true\n        },\n        preferOnline: true\n      });\n      const body = {\n        _id: fullData._id,\n        _rev: fullData._rev,\n        users: fullData.users || {}\n      };\n\n      if (this.name === 'star') {\n        log.info('star', 'starring', body._id);\n        body.users[username] = true;\n        log.verbose('star', 'starring', body);\n      } else {\n        delete body.users[username];\n        log.info('unstar', 'unstarring', body._id);\n        log.verbose('unstar', 'unstarring', body);\n      }\n\n      const data = await fetch.json(pkg.escapedName, { ...this.npm.flatOptions,\n        spec: pkg,\n        method: 'PUT',\n        body\n      });\n      this.npm.output(show + ' ' + pkg.name);\n      log.verbose('star', data);\n      return data;\n    }\n  }\n\n}\n\nmodule.exports = Star;","map":{"version":3,"names":["fetch","require","npa","log","getIdentity","BaseCommand","Star","description","name","usage","params","ignoreImplicitWorkspace","exec","args","length","usageError","unicode","npm","config","get","full","empty","show","pkgs","map","username","flatOptions","pkg","fullData","json","escapedName","spec","query","write","preferOnline","body","_id","_rev","users","info","verbose","data","method","output","module","exports"],"sources":["/Users/chelsea/Documents/0_AllCoding/shoppingstories-v3/node_modules/npm/lib/commands/star.js"],"sourcesContent":["const fetch = require('npm-registry-fetch')\nconst npa = require('npm-package-arg')\nconst log = require('../utils/log-shim')\nconst getIdentity = require('../utils/get-identity')\n\nconst BaseCommand = require('../base-command.js')\nclass Star extends BaseCommand {\n  static description = 'Mark your favorite packages'\n  static name = 'star'\n  static usage = ['[<package-spec>...]']\n  static params = [\n    'registry',\n    'unicode',\n    'otp',\n  ]\n\n  static ignoreImplicitWorkspace = false\n\n  async exec (args) {\n    if (!args.length) {\n      throw this.usageError()\n    }\n\n    // if we're unstarring, then show an empty star image\n    // otherwise, show the full star image\n    const unicode = this.npm.config.get('unicode')\n    const full = unicode ? '\\u2605 ' : '(*)'\n    const empty = unicode ? '\\u2606 ' : '( )'\n    const show = this.name === 'star' ? full : empty\n\n    const pkgs = args.map(npa)\n    const username = await getIdentity(this.npm, this.npm.flatOptions)\n\n    for (const pkg of pkgs) {\n      const fullData = await fetch.json(pkg.escapedName, {\n        ...this.npm.flatOptions,\n        spec: pkg,\n        query: { write: true },\n        preferOnline: true,\n      })\n\n      const body = {\n        _id: fullData._id,\n        _rev: fullData._rev,\n        users: fullData.users || {},\n      }\n\n      if (this.name === 'star') {\n        log.info('star', 'starring', body._id)\n        body.users[username] = true\n        log.verbose('star', 'starring', body)\n      } else {\n        delete body.users[username]\n        log.info('unstar', 'unstarring', body._id)\n        log.verbose('unstar', 'unstarring', body)\n      }\n\n      const data = await fetch.json(pkg.escapedName, {\n        ...this.npm.flatOptions,\n        spec: pkg,\n        method: 'PUT',\n        body,\n      })\n\n      this.npm.output(show + ' ' + pkg.name)\n      log.verbose('star', data)\n      return data\n    }\n  }\n}\nmodule.exports = Star\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}