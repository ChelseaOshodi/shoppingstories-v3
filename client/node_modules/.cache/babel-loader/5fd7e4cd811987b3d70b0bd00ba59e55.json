{"ast":null,"code":"'use strict';\n\nconst colors = require('../colors.js');\n\nconst install = require('./install.js');\n\nmodule.exports = (data, _ref) => {\n  let {\n    color\n  } = _ref;\n  const summary = install.summary(data, {\n    color\n  });\n  const none = data.metadata.vulnerabilities.total === 0;\n  return none ? summary : fullReport(data, {\n    color,\n    summary\n  });\n};\n\nconst fullReport = (data, _ref2) => {\n  let {\n    color,\n    summary\n  } = _ref2;\n  const c = colors(color);\n  const output = [c.white('# npm audit report'), ''];\n  const printed = new Set();\n\n  for (const [, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0) {\n      output.push(printVuln(vuln, c, data.vulnerabilities, printed));\n    }\n  }\n\n  output.push(summary);\n  return output.join('\\n');\n};\n\nconst printVuln = function (vuln, c, vulnerabilities, printed) {\n  let indent = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : '';\n\n  if (printed.has(vuln)) {\n    return null;\n  }\n\n  printed.add(vuln);\n  const output = [];\n  output.push(c.white(vuln.name) + '  ' + vuln.range);\n\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`);\n  }\n\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`);\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`);\n    }\n  }\n\n  if (indent === '') {\n    const {\n      fixAvailable: fa\n    } = vuln;\n\n    if (fa === false) {\n      output.push(c.red('No fix available'));\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`');\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(`${c.yellow('fix available')} via \\`npm audit fix --force\\``, `Will install ${fa.name}@${fa.version}` + `, which is ${fa.isSemVerMajor ? 'a breaking change' : 'outside the stated dependency range'}`);\n      }\n    }\n  }\n\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path));\n  }\n\n  for (const effect of vuln.effects) {\n    const e = printVuln(vulnerabilities[effect], c, vulnerabilities, printed, '  ');\n\n    if (e) {\n      output.push(...e.split('\\n'));\n    }\n  }\n\n  if (indent === '') {\n    output.push('');\n  }\n\n  return output.map(l => `${indent}${l}`).join('\\n');\n};","map":{"version":3,"names":["colors","require","install","module","exports","data","color","summary","none","metadata","vulnerabilities","total","fullReport","c","output","white","printed","Set","vuln","Object","entries","via","filter","v","length","push","printVuln","join","indent","has","add","name","range","severity","title","url","fixAvailable","fa","red","green","yellow","version","isSemVerMajor","path","nodes","dim","effect","effects","e","split","map","l"],"sources":["/Users/chelsea/Documents/0_AllCoding/shoppingstories-v3/node_modules/npm/node_modules/npm-audit-report/lib/reporters/detail.js"],"sourcesContent":["'use strict'\n\nconst colors = require('../colors.js')\nconst install = require('./install.js')\n\nmodule.exports = (data, { color }) => {\n  const summary = install.summary(data, { color })\n  const none = data.metadata.vulnerabilities.total === 0\n  return none ? summary : fullReport(data, { color, summary })\n}\n\nconst fullReport = (data, { color, summary }) => {\n  const c = colors(color)\n  const output = [c.white('# npm audit report'), '']\n\n  const printed = new Set()\n  for (const [, vuln] of Object.entries(data.vulnerabilities)) {\n    // only print starting from the top-level advisories\n    if (vuln.via.filter(v => typeof v !== 'string').length !== 0) {\n      output.push(printVuln(vuln, c, data.vulnerabilities, printed))\n    }\n  }\n\n  output.push(summary)\n\n  return output.join('\\n')\n}\n\nconst printVuln = (vuln, c, vulnerabilities, printed, indent = '') => {\n  if (printed.has(vuln)) {\n    return null\n  }\n\n  printed.add(vuln)\n  const output = []\n\n  output.push(c.white(vuln.name) + '  ' + vuln.range)\n\n  if (indent === '' && (vuln.severity !== 'low' || vuln.severity === 'info')) {\n    output.push(`Severity: ${c.severity(vuln.severity)}`)\n  }\n\n  for (const via of vuln.via) {\n    if (typeof via === 'string') {\n      output.push(`Depends on vulnerable versions of ${c.white(via)}`)\n    } else if (indent === '') {\n      output.push(`${c.white(via.title)} - ${via.url}`)\n    }\n  }\n\n  if (indent === '') {\n    const { fixAvailable: fa } = vuln\n    if (fa === false) {\n      output.push(c.red('No fix available'))\n    } else if (fa === true) {\n      output.push(c.green('fix available') + ' via `npm audit fix`')\n    } else {\n      /* istanbul ignore else - should be impossible, just being cautious */\n      if (typeof fa === 'object' && indent === '') {\n        output.push(\n          `${c.yellow('fix available')} via \\`npm audit fix --force\\``,\n          `Will install ${fa.name}@${fa.version}` +\n          `, which is ${fa.isSemVerMajor ? 'a breaking change' :\n            'outside the stated dependency range'}`\n        )\n      }\n    }\n  }\n\n  for (const path of vuln.nodes) {\n    output.push(c.dim(path))\n  }\n\n  for (const effect of vuln.effects) {\n    const e = printVuln(vulnerabilities[effect], c, vulnerabilities, printed, '  ')\n    if (e) {\n      output.push(...e.split('\\n'))\n    }\n  }\n\n  if (indent === '') {\n    output.push('')\n  }\n\n  return output.map(l => `${indent}${l}`).join('\\n')\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}