{"ast":null,"code":"const pinflight = require('promise-inflight');\n\nconst spawn = require('./spawn.js');\n\nconst LRU = require('lru-cache');\n\nconst revsCache = new LRU({\n  max: 100,\n  ttl: 5 * 60 * 1000\n});\n\nconst linesToRevs = require('./lines-to-revs.js');\n\nmodule.exports = async function (repo) {\n  let opts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo);\n\n    if (cached) {\n      return cached;\n    }\n  }\n\n  return pinflight(`ls-remote:${repo}`, () => spawn(['ls-remote', repo], opts).then(_ref => {\n    let {\n      stdout\n    } = _ref;\n    return linesToRevs(stdout.trim().split('\\n'));\n  }).then(revs => {\n    revsCache.set(repo, revs);\n    return revs;\n  }));\n};","map":{"version":3,"names":["pinflight","require","spawn","LRU","revsCache","max","ttl","linesToRevs","module","exports","repo","opts","noGitRevCache","cached","get","then","stdout","trim","split","revs","set"],"sources":["/Users/chelsea/Documents/0_AllCoding/shoppingstories-v3/node_modules/npm/node_modules/@npmcli/git/lib/revs.js"],"sourcesContent":["const pinflight = require('promise-inflight')\nconst spawn = require('./spawn.js')\nconst LRU = require('lru-cache')\n\nconst revsCache = new LRU({\n  max: 100,\n  ttl: 5 * 60 * 1000,\n})\n\nconst linesToRevs = require('./lines-to-revs.js')\n\nmodule.exports = async (repo, opts = {}) => {\n  if (!opts.noGitRevCache) {\n    const cached = revsCache.get(repo)\n    if (cached) {\n      return cached\n    }\n  }\n\n  return pinflight(`ls-remote:${repo}`, () =>\n    spawn(['ls-remote', repo], opts)\n      .then(({ stdout }) => linesToRevs(stdout.trim().split('\\n')))\n      .then(revs => {\n        revsCache.set(repo, revs)\n        return revs\n      })\n  )\n}\n"],"mappings":"AAAA,MAAMA,SAAS,GAAGC,OAAO,CAAC,kBAAD,CAAzB;;AACA,MAAMC,KAAK,GAAGD,OAAO,CAAC,YAAD,CAArB;;AACA,MAAME,GAAG,GAAGF,OAAO,CAAC,WAAD,CAAnB;;AAEA,MAAMG,SAAS,GAAG,IAAID,GAAJ,CAAQ;EACxBE,GAAG,EAAE,GADmB;EAExBC,GAAG,EAAE,IAAI,EAAJ,GAAS;AAFU,CAAR,CAAlB;;AAKA,MAAMC,WAAW,GAAGN,OAAO,CAAC,oBAAD,CAA3B;;AAEAO,MAAM,CAACC,OAAP,GAAiB,gBAAOC,IAAP,EAA2B;EAAA,IAAdC,IAAc,uEAAP,EAAO;;EAC1C,IAAI,CAACA,IAAI,CAACC,aAAV,EAAyB;IACvB,MAAMC,MAAM,GAAGT,SAAS,CAACU,GAAV,CAAcJ,IAAd,CAAf;;IACA,IAAIG,MAAJ,EAAY;MACV,OAAOA,MAAP;IACD;EACF;;EAED,OAAOb,SAAS,CAAE,aAAYU,IAAK,EAAnB,EAAsB,MACpCR,KAAK,CAAC,CAAC,WAAD,EAAcQ,IAAd,CAAD,EAAsBC,IAAtB,CAAL,CACGI,IADH,CACQ;IAAA,IAAC;MAAEC;IAAF,CAAD;IAAA,OAAgBT,WAAW,CAACS,MAAM,CAACC,IAAP,GAAcC,KAAd,CAAoB,IAApB,CAAD,CAA3B;EAAA,CADR,EAEGH,IAFH,CAEQI,IAAI,IAAI;IACZf,SAAS,CAACgB,GAAV,CAAcV,IAAd,EAAoBS,IAApB;IACA,OAAOA,IAAP;EACD,CALH,CADc,CAAhB;AAQD,CAhBD"},"metadata":{},"sourceType":"script"}