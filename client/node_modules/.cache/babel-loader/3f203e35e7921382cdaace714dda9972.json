{"ast":null,"code":"const hookApi = require('libnpmhook');\n\nconst otplease = require('../utils/otplease.js');\n\nconst relativeDate = require('tiny-relative-date');\n\nconst Table = require('cli-table3');\n\nconst BaseCommand = require('../base-command.js');\n\nclass Hook extends BaseCommand {\n  static description = 'Manage registry hooks';\n  static name = 'hook';\n  static params = ['registry', 'otp'];\n  static usage = ['add <pkg> <url> <secret> [--type=<type>]', 'ls [pkg]', 'rm <id>', 'update <id> <url> <secret>'];\n  static ignoreImplicitWorkspace = true;\n\n  async exec(args) {\n    return otplease(this.npm, { ...this.npm.flatOptions\n    }, opts => {\n      switch (args[0]) {\n        case 'add':\n          return this.add(args[1], args[2], args[3], opts);\n\n        case 'ls':\n          return this.ls(args[1], opts);\n\n        case 'rm':\n          return this.rm(args[1], opts);\n\n        case 'update':\n        case 'up':\n          return this.update(args[1], args[2], args[3], opts);\n\n        default:\n          throw this.usageError();\n      }\n    });\n  }\n\n  async add(pkg, uri, secret, opts) {\n    const hook = await hookApi.add(pkg, uri, secret, opts);\n\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2));\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'));\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'));\n    } else if (!this.npm.silent) {\n      this.npm.output(`+ ${this.hookName(hook)} ${opts.unicode ? ' ➜ ' : ' -> '} ${hook.endpoint}`);\n    }\n  }\n\n  async ls(pkg, opts) {\n    const hooks = await hookApi.ls({ ...opts,\n      package: pkg\n    });\n\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hooks, null, 2));\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hooks[0]).join('\\t'));\n      hooks.forEach(hook => {\n        this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'));\n      });\n    } else if (!hooks.length) {\n      this.npm.output(\"You don't have any hooks configured yet.\");\n    } else if (!this.npm.silent) {\n      if (hooks.length === 1) {\n        this.npm.output('You have one hook configured.');\n      } else {\n        this.npm.output(`You have ${hooks.length} hooks configured.`);\n      }\n\n      const table = new Table({\n        head: ['id', 'target', 'endpoint']\n      });\n      hooks.forEach(hook => {\n        table.push([{\n          rowSpan: 2,\n          content: hook.id\n        }, this.hookName(hook), hook.endpoint]);\n\n        if (hook.last_delivery) {\n          table.push([{\n            colSpan: 1,\n            content: `triggered ${relativeDate(hook.last_delivery)}`\n          }, hook.response_code]);\n        } else {\n          table.push([{\n            colSpan: 2,\n            content: 'never triggered'\n          }]);\n        }\n      });\n      this.npm.output(table.toString());\n    }\n  }\n\n  async rm(id, opts) {\n    const hook = await hookApi.rm(id, opts);\n\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2));\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'));\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'));\n    } else if (!this.npm.silent) {\n      this.npm.output(`- ${this.hookName(hook)} ${opts.unicode ? ' ✘ ' : ' X '} ${hook.endpoint}`);\n    }\n  }\n\n  async update(id, uri, secret, opts) {\n    const hook = await hookApi.update(id, uri, secret, opts);\n\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2));\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'));\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'));\n    } else if (!this.npm.silent) {\n      this.npm.output(`+ ${this.hookName(hook)} ${opts.unicode ? ' ➜ ' : ' -> '} ${hook.endpoint}`);\n    }\n  }\n\n  hookName(hook) {\n    let target = hook.name;\n\n    if (hook.type === 'scope') {\n      target = '@' + target;\n    }\n\n    if (hook.type === 'owner') {\n      target = '~' + target;\n    }\n\n    return target;\n  }\n\n}\n\nmodule.exports = Hook;","map":{"version":3,"names":["hookApi","require","otplease","relativeDate","Table","BaseCommand","Hook","description","name","params","usage","ignoreImplicitWorkspace","exec","args","npm","flatOptions","opts","add","ls","rm","update","usageError","pkg","uri","secret","hook","json","output","JSON","stringify","parseable","Object","keys","join","map","k","silent","hookName","unicode","endpoint","hooks","package","forEach","length","table","head","push","rowSpan","content","id","last_delivery","colSpan","response_code","toString","target","type","module","exports"],"sources":["/Users/chelsea/Documents/0_AllCoding/shoppingstories-v3/node_modules/npm/lib/commands/hook.js"],"sourcesContent":["const hookApi = require('libnpmhook')\nconst otplease = require('../utils/otplease.js')\nconst relativeDate = require('tiny-relative-date')\nconst Table = require('cli-table3')\n\nconst BaseCommand = require('../base-command.js')\nclass Hook extends BaseCommand {\n  static description = 'Manage registry hooks'\n  static name = 'hook'\n  static params = [\n    'registry',\n    'otp',\n  ]\n\n  static usage = [\n    'add <pkg> <url> <secret> [--type=<type>]',\n    'ls [pkg]',\n    'rm <id>',\n    'update <id> <url> <secret>',\n  ]\n\n  static ignoreImplicitWorkspace = true\n\n  async exec (args) {\n    return otplease(this.npm, {\n      ...this.npm.flatOptions,\n    }, (opts) => {\n      switch (args[0]) {\n        case 'add':\n          return this.add(args[1], args[2], args[3], opts)\n        case 'ls':\n          return this.ls(args[1], opts)\n        case 'rm':\n          return this.rm(args[1], opts)\n        case 'update':\n        case 'up':\n          return this.update(args[1], args[2], args[3], opts)\n        default:\n          throw this.usageError()\n      }\n    })\n  }\n\n  async add (pkg, uri, secret, opts) {\n    const hook = await hookApi.add(pkg, uri, secret, opts)\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2))\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'))\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'))\n    } else if (!this.npm.silent) {\n      this.npm.output(`+ ${this.hookName(hook)} ${\n        opts.unicode ? ' ➜ ' : ' -> '\n      } ${hook.endpoint}`)\n    }\n  }\n\n  async ls (pkg, opts) {\n    const hooks = await hookApi.ls({ ...opts, package: pkg })\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hooks, null, 2))\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hooks[0]).join('\\t'))\n      hooks.forEach(hook => {\n        this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'))\n      })\n    } else if (!hooks.length) {\n      this.npm.output(\"You don't have any hooks configured yet.\")\n    } else if (!this.npm.silent) {\n      if (hooks.length === 1) {\n        this.npm.output('You have one hook configured.')\n      } else {\n        this.npm.output(`You have ${hooks.length} hooks configured.`)\n      }\n\n      const table = new Table({ head: ['id', 'target', 'endpoint'] })\n      hooks.forEach((hook) => {\n        table.push([\n          { rowSpan: 2, content: hook.id },\n          this.hookName(hook),\n          hook.endpoint,\n        ])\n        if (hook.last_delivery) {\n          table.push([\n            {\n              colSpan: 1,\n              content: `triggered ${relativeDate(hook.last_delivery)}`,\n            },\n            hook.response_code,\n          ])\n        } else {\n          table.push([{ colSpan: 2, content: 'never triggered' }])\n        }\n      })\n      this.npm.output(table.toString())\n    }\n  }\n\n  async rm (id, opts) {\n    const hook = await hookApi.rm(id, opts)\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2))\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'))\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'))\n    } else if (!this.npm.silent) {\n      this.npm.output(`- ${this.hookName(hook)} ${\n        opts.unicode ? ' ✘ ' : ' X '\n      } ${hook.endpoint}`)\n    }\n  }\n\n  async update (id, uri, secret, opts) {\n    const hook = await hookApi.update(id, uri, secret, opts)\n    if (opts.json) {\n      this.npm.output(JSON.stringify(hook, null, 2))\n    } else if (opts.parseable) {\n      this.npm.output(Object.keys(hook).join('\\t'))\n      this.npm.output(Object.keys(hook).map(k => hook[k]).join('\\t'))\n    } else if (!this.npm.silent) {\n      this.npm.output(`+ ${this.hookName(hook)} ${\n        opts.unicode ? ' ➜ ' : ' -> '\n      } ${hook.endpoint}`)\n    }\n  }\n\n  hookName (hook) {\n    let target = hook.name\n    if (hook.type === 'scope') {\n      target = '@' + target\n    }\n    if (hook.type === 'owner') {\n      target = '~' + target\n    }\n    return target\n  }\n}\nmodule.exports = Hook\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}