{"ast":null,"code":"const npa = require('npm-package-arg');\n\nconst npmFetch = require('npm-registry-fetch');\n\nconst pacote = require('pacote');\n\nconst log = require('../utils/log-shim');\n\nconst otplease = require('../utils/otplease.js');\n\nconst readPackageJsonFast = require('read-package-json-fast');\n\nconst BaseCommand = require('../base-command.js');\n\nconst {\n  resolve\n} = require('path');\n\nconst readJson = async pkg => {\n  try {\n    const json = await readPackageJsonFast(pkg);\n    return json;\n  } catch {\n    return {};\n  }\n};\n\nclass Owner extends BaseCommand {\n  static description = 'Manage package owners';\n  static name = 'owner';\n  static params = ['registry', 'otp', 'workspace', 'workspaces'];\n  static usage = ['add <user> <package-spec>', 'rm <user> <package-spec>', 'ls <package-spec>'];\n  static ignoreImplicitWorkspace = false;\n\n  async completion(opts) {\n    const argv = opts.conf.argv.remain;\n\n    if (argv.length > 3) {\n      return [];\n    }\n\n    if (argv[1] !== 'owner') {\n      argv.unshift('owner');\n    }\n\n    if (argv.length === 2) {\n      return ['add', 'rm', 'ls'];\n    } // reaches registry in order to autocomplete rm\n\n\n    if (argv[2] === 'rm') {\n      if (this.npm.global) {\n        return [];\n      }\n\n      const {\n        name\n      } = await readJson(resolve(this.npm.prefix, 'package.json'));\n\n      if (!name) {\n        return [];\n      }\n\n      const spec = npa(name);\n      const data = await pacote.packument(spec, { ...this.npm.flatOptions,\n        fullMetadata: true\n      });\n\n      if (data && data.maintainers && data.maintainers.length) {\n        return data.maintainers.map(m => m.name);\n      }\n    }\n\n    return [];\n  }\n\n  async exec(_ref) {\n    let [action, ...args] = _ref;\n\n    if (action === 'ls' || action === 'list') {\n      await this.ls(args[0]);\n    } else if (action === 'add') {\n      await this.changeOwners(args[0], args[1], 'add');\n    } else if (action === 'rm' || action === 'remove') {\n      await this.changeOwners(args[0], args[1], 'rm');\n    } else {\n      throw this.usageError();\n    }\n  }\n\n  async execWorkspaces(_ref2, filters) {\n    let [action, ...args] = _ref2;\n    await this.setWorkspaces(filters); // ls pkg or owner add/rm package\n\n    if (action === 'ls' && args.length > 0 || args.length > 1) {\n      const implicitWorkspaces = this.npm.config.get('workspace', 'default');\n\n      if (implicitWorkspaces.length === 0) {\n        log.warn(`Ignoring specified workspace(s)`);\n      }\n\n      return this.exec([action, ...args]);\n    }\n\n    for (const [name] of this.workspaces) {\n      if (action === 'ls' || action === 'list') {\n        await this.ls(name);\n      } else if (action === 'add') {\n        await this.changeOwners(args[0], name, 'add');\n      } else if (action === 'rm' || action === 'remove') {\n        await this.changeOwners(args[0], name, 'rm');\n      } else {\n        throw this.usageError();\n      }\n    }\n  }\n\n  async ls(pkg) {\n    pkg = await this.getPkg(this.npm.prefix, pkg);\n    const spec = npa(pkg);\n\n    try {\n      const packumentOpts = { ...this.npm.flatOptions,\n        fullMetadata: true,\n        preferOnline: true\n      };\n      const {\n        maintainers\n      } = await pacote.packument(spec, packumentOpts);\n\n      if (!maintainers || !maintainers.length) {\n        this.npm.output('no admin found');\n      } else {\n        this.npm.output(maintainers.map(m => `${m.name} <${m.email}>`).join('\\n'));\n      }\n    } catch (err) {\n      log.error('owner ls', \"Couldn't get owner data\", pkg);\n      throw err;\n    }\n  }\n\n  async getPkg(prefix, pkg) {\n    if (!pkg) {\n      if (this.npm.global) {\n        throw this.usageError();\n      }\n\n      const {\n        name\n      } = await readJson(resolve(prefix, 'package.json'));\n\n      if (!name) {\n        throw this.usageError();\n      }\n\n      return name;\n    }\n\n    return pkg;\n  }\n\n  async changeOwners(user, pkg, addOrRm) {\n    if (!user) {\n      throw this.usageError();\n    }\n\n    pkg = await this.getPkg(this.npm.prefix, pkg);\n    log.verbose(`owner ${addOrRm}`, '%s to %s', user, pkg);\n    const spec = npa(pkg);\n    const uri = `/-/user/org.couchdb.user:${encodeURIComponent(user)}`;\n    let u;\n\n    try {\n      u = await npmFetch.json(uri, this.npm.flatOptions);\n    } catch (err) {\n      log.error('owner mutate', `Error getting user data for ${user}`);\n      throw err;\n    } // normalize user data\n\n\n    u = {\n      name: u.name,\n      email: u.email\n    };\n    const data = await pacote.packument(spec, { ...this.npm.flatOptions,\n      fullMetadata: true,\n      preferOnline: true\n    });\n    const owners = data.maintainers || [];\n    let maintainers;\n\n    if (addOrRm === 'add') {\n      const existing = owners.find(o => o.name === u.name);\n\n      if (existing) {\n        log.info('owner add', `Already a package owner: ${existing.name} <${existing.email}>`);\n        return;\n      }\n\n      maintainers = [...owners, u];\n    } else {\n      maintainers = owners.filter(o => o.name !== u.name);\n\n      if (maintainers.length === owners.length) {\n        log.info('owner rm', 'Not a package owner: ' + u.name);\n        return false;\n      }\n\n      if (!maintainers.length) {\n        throw Object.assign(new Error('Cannot remove all owners of a package. Add someone else first.'), {\n          code: 'EOWNERRM'\n        });\n      }\n    }\n\n    const dataPath = `/${spec.escapedName}/-rev/${encodeURIComponent(data._rev)}`;\n\n    try {\n      const res = await otplease(this.npm, this.npm.flatOptions, opts => {\n        return npmFetch.json(dataPath, { ...opts,\n          method: 'PUT',\n          body: {\n            _id: data._id,\n            _rev: data._rev,\n            maintainers\n          },\n          spec\n        });\n      });\n\n      if (addOrRm === 'add') {\n        this.npm.output(`+ ${user} (${spec.name})`);\n      } else {\n        this.npm.output(`- ${user} (${spec.name})`);\n      }\n\n      return res;\n    } catch (err) {\n      throw Object.assign(new Error('Failed to update package: ' + JSON.stringify(err.message)), {\n        code: 'EOWNERMUTATE'\n      });\n    }\n  }\n\n}\n\nmodule.exports = Owner;","map":{"version":3,"names":["npa","require","npmFetch","pacote","log","otplease","readPackageJsonFast","BaseCommand","resolve","readJson","pkg","json","Owner","description","name","params","usage","ignoreImplicitWorkspace","completion","opts","argv","conf","remain","length","unshift","npm","global","prefix","spec","data","packument","flatOptions","fullMetadata","maintainers","map","m","exec","action","args","ls","changeOwners","usageError","execWorkspaces","filters","setWorkspaces","implicitWorkspaces","config","get","warn","workspaces","getPkg","packumentOpts","preferOnline","output","email","join","err","error","user","addOrRm","verbose","uri","encodeURIComponent","u","owners","existing","find","o","info","filter","Object","assign","Error","code","dataPath","escapedName","_rev","res","method","body","_id","JSON","stringify","message","module","exports"],"sources":["/Users/chelsea/Documents/0_AllCoding/shoppingstories-v3/node_modules/npm/lib/commands/owner.js"],"sourcesContent":["const npa = require('npm-package-arg')\nconst npmFetch = require('npm-registry-fetch')\nconst pacote = require('pacote')\nconst log = require('../utils/log-shim')\nconst otplease = require('../utils/otplease.js')\nconst readPackageJsonFast = require('read-package-json-fast')\nconst BaseCommand = require('../base-command.js')\nconst { resolve } = require('path')\n\nconst readJson = async (pkg) => {\n  try {\n    const json = await readPackageJsonFast(pkg)\n    return json\n  } catch {\n    return {}\n  }\n}\n\nclass Owner extends BaseCommand {\n  static description = 'Manage package owners'\n  static name = 'owner'\n  static params = [\n    'registry',\n    'otp',\n    'workspace',\n    'workspaces',\n  ]\n\n  static usage = [\n    'add <user> <package-spec>',\n    'rm <user> <package-spec>',\n    'ls <package-spec>',\n  ]\n\n  static ignoreImplicitWorkspace = false\n\n  async completion (opts) {\n    const argv = opts.conf.argv.remain\n    if (argv.length > 3) {\n      return []\n    }\n\n    if (argv[1] !== 'owner') {\n      argv.unshift('owner')\n    }\n\n    if (argv.length === 2) {\n      return ['add', 'rm', 'ls']\n    }\n\n    // reaches registry in order to autocomplete rm\n    if (argv[2] === 'rm') {\n      if (this.npm.global) {\n        return []\n      }\n      const { name } = await readJson(resolve(this.npm.prefix, 'package.json'))\n      if (!name) {\n        return []\n      }\n\n      const spec = npa(name)\n      const data = await pacote.packument(spec, {\n        ...this.npm.flatOptions,\n        fullMetadata: true,\n      })\n      if (data && data.maintainers && data.maintainers.length) {\n        return data.maintainers.map(m => m.name)\n      }\n    }\n    return []\n  }\n\n  async exec ([action, ...args]) {\n    if (action === 'ls' || action === 'list') {\n      await this.ls(args[0])\n    } else if (action === 'add') {\n      await this.changeOwners(args[0], args[1], 'add')\n    } else if (action === 'rm' || action === 'remove') {\n      await this.changeOwners(args[0], args[1], 'rm')\n    } else {\n      throw this.usageError()\n    }\n  }\n\n  async execWorkspaces ([action, ...args], filters) {\n    await this.setWorkspaces(filters)\n    // ls pkg or owner add/rm package\n    if ((action === 'ls' && args.length > 0) || args.length > 1) {\n      const implicitWorkspaces = this.npm.config.get('workspace', 'default')\n      if (implicitWorkspaces.length === 0) {\n        log.warn(`Ignoring specified workspace(s)`)\n      }\n      return this.exec([action, ...args])\n    }\n\n    for (const [name] of this.workspaces) {\n      if (action === 'ls' || action === 'list') {\n        await this.ls(name)\n      } else if (action === 'add') {\n        await this.changeOwners(args[0], name, 'add')\n      } else if (action === 'rm' || action === 'remove') {\n        await this.changeOwners(args[0], name, 'rm')\n      } else {\n        throw this.usageError()\n      }\n    }\n  }\n\n  async ls (pkg) {\n    pkg = await this.getPkg(this.npm.prefix, pkg)\n    const spec = npa(pkg)\n\n    try {\n      const packumentOpts = { ...this.npm.flatOptions, fullMetadata: true, preferOnline: true }\n      const { maintainers } = await pacote.packument(spec, packumentOpts)\n      if (!maintainers || !maintainers.length) {\n        this.npm.output('no admin found')\n      } else {\n        this.npm.output(maintainers.map(m => `${m.name} <${m.email}>`).join('\\n'))\n      }\n    } catch (err) {\n      log.error('owner ls', \"Couldn't get owner data\", pkg)\n      throw err\n    }\n  }\n\n  async getPkg (prefix, pkg) {\n    if (!pkg) {\n      if (this.npm.global) {\n        throw this.usageError()\n      }\n      const { name } = await readJson(resolve(prefix, 'package.json'))\n      if (!name) {\n        throw this.usageError()\n      }\n\n      return name\n    }\n    return pkg\n  }\n\n  async changeOwners (user, pkg, addOrRm) {\n    if (!user) {\n      throw this.usageError()\n    }\n\n    pkg = await this.getPkg(this.npm.prefix, pkg)\n    log.verbose(`owner ${addOrRm}`, '%s to %s', user, pkg)\n\n    const spec = npa(pkg)\n    const uri = `/-/user/org.couchdb.user:${encodeURIComponent(user)}`\n    let u\n\n    try {\n      u = await npmFetch.json(uri, this.npm.flatOptions)\n    } catch (err) {\n      log.error('owner mutate', `Error getting user data for ${user}`)\n      throw err\n    }\n\n    // normalize user data\n    u = { name: u.name, email: u.email }\n\n    const data = await pacote.packument(spec, {\n      ...this.npm.flatOptions,\n      fullMetadata: true,\n      preferOnline: true,\n    })\n\n    const owners = data.maintainers || []\n    let maintainers\n    if (addOrRm === 'add') {\n      const existing = owners.find(o => o.name === u.name)\n      if (existing) {\n        log.info(\n          'owner add',\n          `Already a package owner: ${existing.name} <${existing.email}>`\n        )\n        return\n      }\n      maintainers = [\n        ...owners,\n        u,\n      ]\n    } else {\n      maintainers = owners.filter(o => o.name !== u.name)\n\n      if (maintainers.length === owners.length) {\n        log.info('owner rm', 'Not a package owner: ' + u.name)\n        return false\n      }\n\n      if (!maintainers.length) {\n        throw Object.assign(\n          new Error(\n            'Cannot remove all owners of a package. Add someone else first.'\n          ),\n          { code: 'EOWNERRM' }\n        )\n      }\n    }\n\n    const dataPath = `/${spec.escapedName}/-rev/${encodeURIComponent(data._rev)}`\n    try {\n      const res = await otplease(this.npm, this.npm.flatOptions, opts => {\n        return npmFetch.json(dataPath, {\n          ...opts,\n          method: 'PUT',\n          body: {\n            _id: data._id,\n            _rev: data._rev,\n            maintainers,\n          },\n          spec,\n        })\n      })\n      if (addOrRm === 'add') {\n        this.npm.output(`+ ${user} (${spec.name})`)\n      } else {\n        this.npm.output(`- ${user} (${spec.name})`)\n      }\n      return res\n    } catch (err) {\n      throw Object.assign(\n        new Error('Failed to update package: ' + JSON.stringify(err.message)),\n        { code: 'EOWNERMUTATE' }\n      )\n    }\n  }\n}\n\nmodule.exports = Owner\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}